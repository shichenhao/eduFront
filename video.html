<!DOCTYPE html>
<html>
<head>
	<title>视频中心</title>
    <meta http-equiv="content-type" content="text/html;charset=utf-8">
  	<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no,viewport-fit=cover">
	<link rel="stylesheet" type="text/css" href="css.css">
</head>
<body>
	<div class="header">
		<div class="main">
			<div class="logo">
				<a href="index.html"></a>
				<span class="menuShow"></span>
			</div>
			<div class="menu">
				<a href="index.html">首页</a>
				<a href="material.html">教材&教参</a>
				<a href="authentication.html">认证测评</a>
				<a href="study.html">研学</a>
				<a href="art.html">艺术节</a>
				<a href="campus.html">戏剧校园</a>
				<a href="partner.html">合作伙伴</a>
				<a href="box.html">戏剧盒子</a>
				<a href="about.html">关于我们</a>
				<a class="active" href="video.html">视频中心</a>
				<a class="login">
					<font class="isLogin">登录</font>
					<span>
						<font class="upPas">修改密码</font>
						<font class="loginOut">退出</font>
					</span>
				</a>
			</div>
			<div class="headerApp">
				<span>APP下载</span>
				<div>
					<img src="images/i_111.png">
				</div>
			</div>
		</div>
	</div>
	<div class="banner banner3 banner11"></div>
	<div class="video">
		<div class="main">
			<div class="isVip">
				<div class="videoH2">
					会员特权
				</div>
				<div class="viedeSel">
					<img src="images/vip_06.png">
					<span>您可选择2个剧目完整观看</span>
				</div>
			</div>
			<div class="videoVip">
				<div class="videoH2">
					戏剧示范课
				</div>
				<div class="viedeVip">
					<div class="switch switchLeft"></div>
					<div class="switchCont">
					</div>
					<div class="switch switchRight"></div>
				</div>
			</div>
			<div class="video1">
				<div class="videoH2">
					中国传统故事
				</div>
				<div class="videoItem">
					<div class="switch switchLeft"></div>
					<div class="switchCont">
					</div>
					<div class="switch switchRight"></div>
				</div>
			</div>
			<div class="video2">
				<div class="videoH2">
					经典课本剧
				</div>
				<div class="videoItem">
					<div class="switch switchLeft"></div>
					<div class="switchCont">
					</div>
					<div class="switch switchRight"></div>
				</div>
			</div>
			<div class="video3">
				<div class="videoH2">
					经典故事改编
				</div>
				<div class="videoItem">
					<div class="switch switchLeft"></div>
					<div class="switchCont">
					</div>
					<div class="switch switchRight"></div>
				</div>
			</div>
			<div class="video4">
				<div class="videoH2">
					外国精彩故事改编
				</div>
				<div class="videoItem">
					<div class="switch switchLeft"></div>
					<div class="switchCont">
					</div>
					<div class="switch switchRight"></div>
				</div>
			</div>
			<div class="video5">
				<div class="videoH2">
					戏剧示范课初级
				</div>
				<div class="videoItem">
					<div class="switch switchLeft"></div>
					<div class="switchCont">
					</div>
					<div class="switch switchRight"></div>
				</div>
			</div>
			<div class="video6">
				<div class="videoH2">
					戏剧示范课中级
				</div>
				<div class="videoItem">
					<div class="switch switchLeft"></div>
					<div class="switchCont">
					</div>
					<div class="switch switchRight"></div>
				</div>
			</div>
			<div class="video7">
				<div class="videoH2">
					戏剧示范课高级
				</div>
				<div class="videoItem">
					<div class="switch switchLeft"></div>
					<div class="switchCont">
					</div>
					<div class="switch switchRight"></div>
				</div>
			</div>
		</div>
	</div>
	<div class="addVideo">
		<div class="addBox">
			<h2>会员权益</h2>
			<p>您还可选择2个视频完整观看</p>
			<span class="close closes">✖</span>
			<div class="scroll">
				<dl>
					<dt>中国传统故事</dt>
					<dd><label><input type="checkbox">阿拉山口大家</label></dd>
				</dl>
			</div>
			<div class="addBtn">
				<span class="addSubmit">确定</span>
				<span class="closes">取消</span>
			</div>
		</div>
	</div>
	<script type="text/javascript" src="js/baseHtml.js"></script>
	<script src="js/jquery.min.js"></script>
	<script src="js/jqpaginator.min.js"></script>
	<script src="js/base.js"></script>
	<script src="js/footer.js"></script>
	<script type="text/javascript">


			var videoLs = 0
			var list = [];
			var vipList = [];
			var checkList = [];
			var video1 = [];
			var video2 = [];
			var video3 = [];
			var video4 = [];
			var video5 = [];
			var video6 = [];
			var video7 = [];
			var video8 = [];
			var video9 = [];
			var video10 = [];
			var video11 = [];

			videoLs = localStorage.getItem('userInfo') ? JSON.parse(localStorage.getItem('userInfo')).associatorUserType.videoNum : 0
			if(videoLs){
				$('.viedeSel span').html('您可选择'+videoLs+'个剧目完整观看')
			}


		$(function(){

			// 视频播放
			$(".switchCont").on('click','div',function(){
				$('.switchCont .active').removeClass("active");
				$('.switchCont div').find('video')[0].pause()
				$(this).addClass("active");
				//$('.switchCont .active').find('video')[0].play()
				//$(this).find('video')[0].play()
			})

			// 关闭绑定权益
			$('.addVideo .closes').click(function(){
				$(".addVideo").hide();
			})
			// 关闭绑定权益
			$('.viedeSel').click(function(){
				$(".addVideo").show();
			})

			$('.addSubmit').click(function(){
				var vals = ''
				if($('.scroll input:checkbox:checked').length > videoLs){
    				$(".alertPop").fadeIn().delay(500).fadeOut(200).find('div').html('您最多可以选择'+videoLs+'个视频');  
					return false;
				}
	            $.each($('.scroll input:checkbox:checked'),function(){
	                vals+= $(this).val() +','
	            });
				var param ={
					videoIds:vals
				}
				createUserVideo(param)
			})




			getVideo({
				limit:200
			});


			if(localStorage.getItem('userInfo')){
				getVideoVip({
					limit:200
				});
				getVideoList()
			}


		        $('.viedeVip .switchLeft').click(function(){
	                $(this).closest(".viedeVip").find(".switchCont").stop().animate({ "margin-left": -870 }, 500, function() {
		                $(this).closest(".viedeVip").find(".switchCont div").first().insertAfter($(this).closest(".switchCont").find("div:last")); 
		                $(this).closest(".viedeVip").find(".switchCont").css("margin-left", -435); //初始化marginleft
		            });
		        })
		        $('.viedeVip .switchRight').click(function(){
	                $(this).closest(".viedeVip").find(".switchCont").stop().animate({ "margin-left":  0 }, 500, function() {
		                $(this).closest(".viedeVip").find(".switchCont div").last().insertBefore($(this).closest(".switchCont").find("div:first")); 
		                $(this).closest(".viedeVip").find(".switchCont").css("margin-left", -435); //初始化marginleft
		            });
		        })



     
		    $(".videoItem").each(function(){
		        $(this).find(".switchLeft").click(function(){
	                $(this).closest(".videoItem").find(".switchCont").stop().animate({ "margin-left": -488 }, 500, function() {
		                $(this).closest(".videoItem").find(".switchCont div").first().insertAfter($(this).closest(".switchCont").find("div:last")); 
		                $(this).closest(".videoItem").find(".switchCont").css("margin-left", -244); //初始化marginleft
		            });
		        })
		        $(this).find(".switchRight").click(function(){
	                $(this).closest(".videoItem").find(".switchCont").stop().animate({ "margin-left":  0 }, 500, function() {
		                $(this).closest(".videoItem").find(".switchCont div").last().insertBefore($(this).closest(".switchCont").find("div:first")); 
		                $(this).closest(".videoItem").find(".switchCont").css("margin-left", -244); //初始化marginleft
		            });
		        })
		    })


		})
		// 获取免费视频
		function getVideo(data){
		    ajax({
		    	url:'/medu/user/findMVideoList',
		    	data:data,
		    	success:function(data){
		    		list = data.value
		    		list.forEach(function(item){
		    			if(item.type===1){
		    				video1.push(item)
		    			}
		    			else if(item.type===2){
		    				video2.push(item)
		    			}
		    			else if(item.type===3){
		    				video3.push(item)
		    			}
		    			else if(item.type===4){
		    				video4.push(item)
		    			}
		    			else if(item.type===5){
		    				video5.push(item)
		    			}
		    			else if(item.type===6){
		    				video6.push(item)
		    			}
		    			else if(item.type===7){
		    				video7.push(item)
		    			}
		    			else if(item.type===8){
		    				video8.push(item)
		    			}
		    			else if(item.type===9){
		    				video9.push(item)
		    			}
		    			else if(item.type===10){
		    				video10.push(item)
		    			}
		    			else if(item.type===11){
		    				video11.push(item)
		    			}
		    		})
	    			toHtml();
		    	}
		    })
		}
		//插入视频
		function toHtml(){
			var html1 = '';
			var html2 = '';
			var html3 = '';
			var html4 = '';
			var html5 = '';
			var html6 = '';
			var html7 = '';
			var html8 = '';
			var html9 = '';
			var html10 = '';
			var html11 = '';
			video1.forEach(function(item){
				html1+='<div><img src="'+item.headImgUrl+'"><video src="'+item.url+'"  width="100%" height="100%" controls="controls"></video><span>'+item.name+'</span><p>适合'+item.beginAge+'~'+item.endAge+'岁 | <font>时长：约'+item.timeLength+'分钟</font></p></div>'
			})
			video2.forEach(function(item){
				html2+='<div><img src="'+item.headImgUrl+'"><video src="'+item.url+'"  width="100%" height="100%" controls="controls"></video><span>'+item.name+'</span><p>适合'+item.beginAge+'~'+item.endAge+'岁 | <font>时长：约'+item.timeLength+'分钟</font></p></div>'
			})
			video3.forEach(function(item){
				html3+='<div><img src="'+item.headImgUrl+'"><video src="'+item.url+'"  width="100%" height="100%" controls="controls"></video><span>'+item.name+'</span><p>适合'+item.beginAge+'~'+item.endAge+'岁 | <font>时长：约'+item.timeLength+'分钟</font></p></div>'
			})
			video4.forEach(function(item){
				html4+='<div><img src="'+item.headImgUrl+'"><video src="'+item.url+'"  width="100%" height="100%" controls="controls"></video><span>'+item.name+'</span><p>适合'+item.beginAge+'~'+item.endAge+'岁 | <font>时长：约'+item.timeLength+'分钟</font></p></div>'
			})
			video5.forEach(function(item){
				html5+='<div><img src="'+item.headImgUrl+'"><video src="'+item.url+'"  width="100%" height="100%" controls="controls"></video><span>'+item.name+'</span><p>适合'+item.beginAge+'~'+item.endAge+'岁 | <font>时长：约'+item.timeLength+'分钟</font></p></div>'
			})
			video6.forEach(function(item){
				html6+='<div><img src="'+item.headImgUrl+'"><video src="'+item.url+'"  width="100%" height="100%" controls="controls"></video><span>'+item.name+'</span><p>适合'+item.beginAge+'~'+item.endAge+'岁 | <font>时长：约'+item.timeLength+'分钟</font></p></div>'
			})
			video7.forEach(function(item){
				html7+='<div><img src="'+item.headImgUrl+'"><video src="'+item.url+'"  width="100%" height="100%" controls="controls"></video><span>'+item.name+'</span><p>适合'+item.beginAge+'~'+item.endAge+'岁 | <font>时长：约'+item.timeLength+'分钟</font></p></div>'
			})
			video8.forEach(function(item){
				html8+='<div><img src="'+item.headImgUrl+'"><video src="'+item.url+'"  width="100%" height="100%" controls="controls"></video><span>'+item.name+'</span><p>适合'+item.beginAge+'~'+item.endAge+'岁 | <font>时长：约'+item.timeLength+'分钟</font></p></div>'
			})
			video9.forEach(function(item){
				html9+='<div><img src="'+item.headImgUrl+'"><video src="'+item.url+'"  width="100%" height="100%" controls="controls"></video><span>'+item.name+'</span><p>适合'+item.beginAge+'~'+item.endAge+'岁 | <font>时长：约'+item.timeLength+'分钟</font></p></div>'
			})
			video10.forEach(function(item){
				html10+='<div><img src="'+item.headImgUrl+'"><span<video src="'+item.url+'"  width="100%" height="100%" controls="controls"></video>>'+item.name+'</span><p>适合'+item.beginAge+'~'+item.endAge+'岁 | <font>时长：约'+item.timeLength+'分钟</font></p></div>'
			})
			video11.forEach(function(item){
				html11+='<div><img src="'+item.headImgUrl+'"><span<video src="'+item.url+'"  width="100%" height="100%" controls="controls"></video>>'+item.name+'</span><p>适合'+item.beginAge+'~'+item.endAge+'岁 | <font>时长：约'+item.timeLength+'分钟</font></p></div>'
			})
			$('.video1 .switchCont').html(html1)
			$('.video2 .switchCont').html(html2)
			$('.video3 .switchCont').html(html3)
			$('.video4 .switchCont').html(html4)
			$('.video5 .switchCont').html(html5)
			$('.video6 .switchCont').html(html6)
			$('.video7 .switchCont').html(html7)
			$('.video8 .switchCont').html(html8)
			$('.video9 .switchCont').html(html9)
			$('.video10 .switchCont').html(html10)
			$('.video11 .switchCont').html(html11)
			if(!video1.length){
				$('.video1').hide()
			}else if(video1.length<6){
				$('.video1 .switch').remove();
				$('.video1 .switchCont').css({margin:0})
			}
			if(!video2.length){
				$('.video2').hide()
			}else if(video2.length<6){
				$('.video2 .switch').remove();
				$('.video2 .switchCont').css({margin:0})
			}
			if(!video3.length){
				$('.video3').hide()
			}else if(video3.length<6){
				$('.video3 .switch').remove();
				$('.video3 .switchCont').css({margin:0})
			}
			if(!video4.length){
				$('.video4').hide()
			}else if(video4.length<6){
				$('.video4 .switch').remove();
				$('.video4 .switchCont').css({margin:0})
			}
			if(!video5.length){
				$('.video5').hide()
			}else if(video5.length<6){
				$('.video5 .switch').remove();
				$('.video5 .switchCont').css({margin:0})
			}
			if(!video6.length){
				$('.video6').hide()
			}else if(video6.length<6){
				$('.video6 .switch').remove();
				$('.video6 .switchCont').css({margin:0})
			}
			if(!video7.length){
				$('.video7').hide()
			}else if(video7.length<6){
				$('.video7 .switch').remove();
				$('.video7 .switchCont').css({margin:0})
			}
			if(!video8.length){
				$('.video8').hide()
			}else if(video8.length<6){
				$('.video8 .switch').remove();
				$('.video8 .switchCont').css({margin:0})
			}
			if(!video9.length){
				$('.video9').hide()
			}else if(video9.length<6){
				$('.video9 .switch').remove();
				$('.video9 .switchCont').css({margin:0})
			}
			if(!video10.length){
				$('.video10').hide()
			}else if(video10.length<6){
				$('.video10 .switch').remove();
				$('.video10 .switchCont').css({margin:0})
			}
			if(!video11.length){
				$('.video11').hide()
			}else if(video11.length<6){
				$('.video11 .switch').remove();
				$('.video11 .switchCont').css({margin:0})
			}

		}
		// 获取会员视频
		function getVideoVip(data){
			var html ='';

		    ajax({
		    	url:'/medu/user/findMVideoListForVip',
		    	data:data,
		    	success:function(data){
		    		checkList = data.value;

		    		checkList.forEach(function(item){
		    			html+= '<dd><label><input type="checkbox" value='+item.id+'>'+item.name+'</label></dd>'
		    		})
		    		$('.scroll dl').html(html)
		    	}
		    })
		}
		// 查询会员已添加的视频信息列表
		function getVideoList(data){
			var html ='';

		    ajax({
		    	url:'/medu/user/findMAssociatorUserVideoList',
		    	data:data,
		    	success:function(res){

		    		vipList= res.value

		    		vipList.forEach(function(item){
		    			html+= '<div><img src="'+item.video.headImgUrl+'"><video src="'+item.video.url+'"  width="100%" height="100%" controls="controls"></video></div>'
		    		})
		    		$('.viedeVip .switchCont').html(html)

		    		if(vipList.length){
		    			$(".videoVip").show()
		    			$(".isVip").remove();
		    			if(vipList.length<4){
		    				$(".videoVip .switch ").remove()	
							$('.videoVip .switchCont').css({margin:0})	    				
		    			}
		    		}else{
		    			$(".isVip").show();	    			
		    		}

		    	}
		    })
		}
		// 会员添加视频
		function createUserVideo(data){

		    ajax({
		    	url:'/medu/user/createOrMergeMAssociatorUserVideo',
		    	data:data,
		    	success:function(res){
		    		$(".addVideo").hide();
    				window.location.reload()
		    	}
		    })
		}
	</script>
</body>
</html>